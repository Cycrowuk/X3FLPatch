<?xml version="1.0" standalone="yes" ?>
<?xml-stylesheet href="x2script.xsl" type="text/xsl" ?>
<script>
<name>!ship.signal.attacked</name>
<version>12</version>
<engineversion>62</engineversion>
<description>Asynchron signal. attacked</description>
<arguments>
<argument index="1" name="attacker" type="Var/Ship/Station" desc="the attacker" />
<argument index="2" name="action" type="Var/Number" desc="action" />
<argument index="3" name="a.fromFollower" type="Var/Boolean" desc="Is From follower" />
</arguments>
<sourceplaintext>
<![CDATA[
  do if [OWNER] == Neutral Race
    return null
  
  * if its the same race, then dont react
@ skip if [THIS] -> call script !lib.canattack :  Target=$attacker
    return null
  
  if [OWNER] == Player
    $cmd = [THIS] -> get command
    if $cmd == COMMAND_NONE
      do if [THIS] == [PLAYERSHIP]
        return null
      $pilot = [THIS] ->get pilot speaker
      skip if $pilot -> exists
        return null
    end
  end
  
  * dont counter attack friendlies
  if [OWNER] != Player
    $owner = $attacker -> get true owner
    if $owner != Player
      $noto = get notoriety from race [TRUEOWNER] to race $owner
      if $noto >= [Notoriety.Ally]
        return null
      end
    end
  end
  
  * ST/UT use their own signals:
  do if [THIS] -> is script lib.ship.signal.attacked.trader on stack of task=0
    return null
  
  $response.type = [THIS] ->get attacked response type
  if [THIS] -> is of class Stationary Ship
    $response.type = [Attacked.Defend]
  end
  
  if $response.type == [Attacked.Ignore]
    gosub sub.DropDrones
    return null
    
  else if $response.type == [Attacked.Evade]
    gosub sub.DropDrones
    gosub sub.Evade
    
  else if $response.type == [Attacked.Flee]
    gosub sub.Flee
    
  else if $response.type == [Attacked.Defend]
    gosub sub.Evade
    
  * check if already a attack is executed
    do if is script with prio 99 on stack
      return [TRUE]
  * already attacking the attacker...
    $attacktarget = [THIS] -> get attack target
    skip if $attacker != $attacktarget
      return null
    skip if [THIS] != [PLAYERSHIP]
      return null
    skip if $attacker
      return null
    skip if $attacker -> exists
      return null
    skip if [THIS] -> is $attacker a enemy
      return null
    
    gosub sub.DropDrones
    
    $has.laser = [THIS] -> get maximum laser strength
    if $has.laser
      $followmode = [THIS] -> get follow mode
      [THIS] ->set follow mode [FALSE]
      
      set script priority to 99
@     = [THIS] -> call script !fight.attack.object :  the victim=$attacker  follow in new sector=null
      
      [THIS] ->set follow mode $followmode
      return [TRUE]
    else if not is script with prio 50 on stack
      gosub sub.Flee
    end
  end
  return null
  
  * Changelog:
  * v3: script does not trigger response if response is already running (on task 50)
  * v4: ships without fight software flee, do not ignore attack
  
  sub.IsLittleShip:
  $littleship = [THIS] -> is of class Little Ship
  do if [THIS] -> is of class M6
    $littleship = [TRUE]
  do if [THIS] -> is of class M7
    $littleship = [TRUE]
  endsub
  
  sub.DropDrones:
  if [THIS] ->get should drop drones
    $drone.time = [THIS] -> get local variable: name='drop.drones'
    $time = playing time
    if ! $drone.time OR $time > ( $drone.time + 180 )
      [THIS] ->set local variable: name='drop.drones' value=null
      if [THIS] -> launch 4 fight drones: protect me or attack target=$attacker
        [THIS] ->set local variable: name='drop.drones' value=$time
      end
    end
  end
  endsub
  
  sub.Flee:
  if not [THIS] -> is script !ship.sh.attack.ts.flee on stack of task=0
    gosub sub.DropDrones
    
    if [THIS] -> is invincible
      do if [THIS] ->is from mission
        return [TRUE]
    end
    
    if $action == [ACTION_LAND_IN_STATION] OR $action == [ACTION_ENTER_GATE] OR $a.fromFollower
      return [TRUE]
    end
    
    $ship.dest = [THIS] -> get destination
    if $ship.dest -> exists
      $dest.sector = $ship.dest -> get sector
      $jumps = get jumps from sector [SECTOR] to sector $dest.sector
      do if $jumps <= 1
        return [TRUE]
    end
    
    [THIS] ->set relation against $attacker to Foe
    $flags = [Find.Nearest] | [Find.DockingAllowed]
    $station = find station: sector=[SECTOR] class or type=Station race=null flags=$flags refobj=[THIS] maxdist=null maxnum=1 refpos=null
    if $station -> exists
      do if $station == $ship.dest
        return [TRUE]
      
      $followmode = [THIS] -> get follow mode
      [THIS] ->set follow mode [FALSE]
      set script priority to 50
@     = [THIS] -> call script !ship.sh.attack.ts.flee :  the attacker=$attacker  station to dock at=$station
      [THIS] ->set follow mode $followmode
    end
  end
  return [TRUE]
  endsub
  
  sub.Evade:
@ = [THIS] -> call script plugin.turbo.npcuse : 
  if [THIS] -> is in active sector
    gosub sub.IsLittleShip
    if $littleship AND $action != [ACTION_LAND_IN_STATION] AND $action != [ACTION_ENTER_GATE] AND $attacker
      $shieldrandom = random value from 3000 to 6000 - 1
      $hullrandom = random value from 50 to 80 - 1
      $hull = [THIS] -> get hull percent
      $shield = [THIS] -> get current shield strength
      if $shield < $shieldrandom OR $hull < $hullrandom
        $intensity = random value from 80 to 100 - 1
        $timeout = random value from 5000 to 15000 - 1
@       = [THIS] -> defensive move: type=null, intensity=$intensity, timeout=$timeoutms, avoid object=$attacker
      end
    end
  end
  endsub
  return null
]]>
</sourceplaintext>
<sourcetext>
<line indent=""><var>do&#160;if&#160;</var><var>[OWNER]</var><text>&#160;</text><var>==</var><text>&#160;</text><var>Neutral&#160;Race</var></line>
<line indent="&#160;"><text>return&#160;</text><var>null</var></line>
<line indent=""></line>
<line indent=""><comment><text>*&#160;</text><var>if&#160;its&#160;the&#160;same&#160;race,&#160;then&#160;dont&#160;react</var></comment></line>
<line interruptable="@" indent=""><var>skip&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>!lib.canattack</call><text>&#160;:&#160;</text><text>&#160;Target=</text><var>$attacker</var></line>
<line indent="&#160;"><text>return&#160;</text><var>null</var></line>
<line indent=""></line>
<line indent=""><var>if&#160;</var><var>[OWNER]</var><text>&#160;</text><var>==</var><text>&#160;</text><var>Player</var></line>
<line indent="&#160;"><var>$cmd&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;command</text></line>
<line indent="&#160;"><var>if&#160;</var><var>$cmd</var><text>&#160;</text><var>==</var><text>&#160;</text><var>COMMAND_NONE</var></line>
<line indent="&#160;&#160;"><var>do&#160;if&#160;</var><var>[THIS]</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[PLAYERSHIP]</var></line>
<line indent="&#160;&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;&#160;"><var>$pilot&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>get&#160;pilot&#160;speaker</text></line>
<line indent="&#160;&#160;"><var>skip&#160;if&#160;</var><var>$pilot&#160;-&gt;</var><text>&#160;exists</text></line>
<line indent="&#160;&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""></line>
<line indent=""><comment><text>*&#160;</text><var>dont&#160;counter&#160;attack&#160;friendlies</var></comment></line>
<line indent=""><var>if&#160;</var><var>[OWNER]</var><text>&#160;</text><var>!=</var><text>&#160;</text><var>Player</var></line>
<line indent="&#160;"><var>$owner&#160;=&#160;</var><var>$attacker&#160;-&gt;</var><text>&#160;get&#160;true&#160;owner</text></line>
<line indent="&#160;"><var>if&#160;</var><var>$owner</var><text>&#160;</text><var>!=</var><text>&#160;</text><var>Player</var></line>
<line indent="&#160;&#160;"><var>$noto&#160;=&#160;</var><text>get&#160;notoriety&#160;from&#160;race&#160;</text><var>[TRUEOWNER]</var><text>&#160;to&#160;race&#160;</text><var>$owner</var></line>
<line indent="&#160;&#160;"><var>if&#160;</var><var>$noto</var><text>&#160;</text><var>&gt;=</var><text>&#160;</text><var>[Notoriety.Ally]</var></line>
<line indent="&#160;&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;&#160;"><text>end</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""></line>
<line indent=""><comment><text>*&#160;</text><var>ST/UT&#160;use&#160;their&#160;own&#160;signals:</var></comment></line>
<line indent=""><var>do&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;script&#160;</text><call>lib.ship.signal.attacked.trader</call><text>&#160;on&#160;stack&#160;of&#160;task=</text><var>0</var></line>
<line indent="&#160;"><text>return&#160;</text><var>null</var></line>
<line indent=""></line>
<line indent=""><var>$response.type&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>get&#160;attacked&#160;response&#160;type</text></line>
<line indent=""><var>if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;of&#160;class&#160;</text><var>Stationary&#160;Ship</var></line>
<line indent="&#160;"><var>$response.type&#160;=&#160;</var><var>[Attacked.Defend]</var></line>
<line indent=""><text>end</text></line>
<line indent=""></line>
<line indent=""><var>if&#160;</var><var>$response.type</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[Attacked.Ignore]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.DropDrones</var></line>
<line indent="&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$response.type</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[Attacked.Evade]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.DropDrones</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.Evade</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$response.type</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[Attacked.Flee]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.Flee</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$response.type</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[Attacked.Defend]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.Evade</var></line>
<line indent="&#160;"></line>
<line indent=""><comment><text>*&#160;</text><var>check&#160;if&#160;already&#160;a&#160;attack&#160;is&#160;executed</var></comment></line>
<line indent="&#160;"><var>do&#160;if&#160;</var><text>is&#160;script&#160;with&#160;prio&#160;</text><var>99</var><text>&#160;on&#160;stack</text></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent=""><comment><text>*&#160;</text><var>already&#160;attacking&#160;the&#160;attacker...</var></comment></line>
<line indent="&#160;"><var>$attacktarget&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;attack&#160;target</text></line>
<line indent="&#160;"><var>skip&#160;if&#160;</var><var>$attacker</var><text>&#160;</text><var>!=</var><text>&#160;</text><var>$attacktarget</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"><var>skip&#160;if&#160;</var><var>[THIS]</var><text>&#160;</text><var>!=</var><text>&#160;</text><var>[PLAYERSHIP]</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"><var>skip&#160;if&#160;</var><var>$attacker</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"><var>skip&#160;if&#160;</var><var>$attacker&#160;-&gt;</var><text>&#160;exists</text></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"><var>skip&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;</text><var>$attacker</var><text>&#160;a&#160;enemy</text></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>null</var></line>
<line indent="&#160;"></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.DropDrones</var></line>
<line indent="&#160;"></line>
<line indent="&#160;"><var>$has.laser&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;maximum&#160;laser&#160;strength</text></line>
<line indent="&#160;"><var>if&#160;</var><var>$has.laser</var></line>
<line indent="&#160;&#160;"><var>$followmode&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;follow&#160;mode</text></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;follow&#160;mode&#160;</text><var>[FALSE]</var></line>
<line indent="&#160;&#160;"></line>
<line indent="&#160;&#160;"><text>set&#160;script&#160;priority&#160;to&#160;</text><var>99</var></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>!fight.attack.object</call><text>&#160;:&#160;</text><text>&#160;the&#160;victim=</text><var>$attacker</var><text>&#160;</text><text>&#160;follow&#160;in&#160;new&#160;sector=</text><var>null</var></line>
<line indent="&#160;&#160;"></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;follow&#160;mode&#160;</text><var>$followmode</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent="&#160;"><var>else&#160;if&#160;not&#160;</var><text>is&#160;script&#160;with&#160;prio&#160;</text><var>50</var><text>&#160;on&#160;stack</text></line>
<line indent="&#160;&#160;"><text>gosub&#160;</text><var>sub.Flee</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""><text>return&#160;</text><var>null</var></line>
<line indent=""></line>
<line indent=""><comment><text>*&#160;</text><var>Changelog:</var></comment></line>
<line indent=""><comment><text>*&#160;</text><var>v3:&#160;script&#160;does&#160;not&#160;trigger&#160;response&#160;if&#160;response&#160;is&#160;already&#160;running&#160;(on&#160;task&#160;50)</var></comment></line>
<line indent=""><comment><text>*&#160;</text><var>v4:&#160;ships&#160;without&#160;fight&#160;software&#160;flee,&#160;do&#160;not&#160;ignore&#160;attack</var></comment></line>
<line indent=""></line>
<line indent=""><var>sub.IsLittleShip</var><text>:</text></line>
<line indent=""><var>$littleship&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;of&#160;class&#160;</text><var>Little&#160;Ship</var></line>
<line indent=""><var>do&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;of&#160;class&#160;</text><var>M6</var></line>
<line indent="&#160;"><var>$littleship&#160;=&#160;</var><var>[TRUE]</var></line>
<line indent=""><var>do&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;of&#160;class&#160;</text><var>M7</var></line>
<line indent="&#160;"><var>$littleship&#160;=&#160;</var><var>[TRUE]</var></line>
<line indent=""><text>endsub</text></line>
<line indent=""></line>
<line indent=""><var>sub.DropDrones</var><text>:</text></line>
<line indent=""><var>if&#160;</var><var>[THIS]&#160;-&gt;</var><text>get&#160;should&#160;drop&#160;drones</text></line>
<line indent="&#160;"><var>$drone.time&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;local&#160;variable:&#160;name=</text><var>'drop.drones'</var></line>
<line indent="&#160;"><var>$time&#160;=&#160;</var><text>playing&#160;time</text></line>
<line indent="&#160;"><var>if&#160;</var><var>!</var><text>&#160;</text><var>$drone.time</var><text>&#160;</text><var>OR</var><text>&#160;</text><var>$time</var><text>&#160;</text><var>&gt;</var><text>&#160;</text><var>(</var><text>&#160;</text><var>$drone.time</var><text>&#160;</text><var>+</var><text>&#160;</text><var>180</var><text>&#160;</text><var>)</var></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'drop.drones'</var><text>&#160;value=</text><var>null</var></line>
<line indent="&#160;&#160;"><var>if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;launch&#160;</text><var>4</var><text>&#160;fight&#160;drones:&#160;protect&#160;me&#160;or&#160;attack&#160;target=</text><var>$attacker</var></line>
<line indent="&#160;&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'drop.drones'</var><text>&#160;value=</text><var>$time</var></line>
<line indent="&#160;&#160;"><text>end</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""><text>endsub</text></line>
<line indent=""></line>
<line indent=""><var>sub.Flee</var><text>:</text></line>
<line indent=""><var>if&#160;not&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;script&#160;</text><call>!ship.sh.attack.ts.flee</call><text>&#160;on&#160;stack&#160;of&#160;task=</text><var>0</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.DropDrones</var></line>
<line indent="&#160;"></line>
<line indent="&#160;"><var>if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;invincible</text></line>
<line indent="&#160;&#160;"><var>do&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>is&#160;from&#160;mission</text></line>
<line indent="&#160;&#160;&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"></line>
<line indent="&#160;"><var>if&#160;</var><var>$action</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[ACTION_LAND_IN_STATION]</var><text>&#160;</text><var>OR</var><text>&#160;</text><var>$action</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[ACTION_ENTER_GATE]</var><text>&#160;</text><var>OR</var><text>&#160;</text><var>$a.fromFollower</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"></line>
<line indent="&#160;"><var>$ship.dest&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;destination</text></line>
<line indent="&#160;"><var>if&#160;</var><var>$ship.dest&#160;-&gt;</var><text>&#160;exists</text></line>
<line indent="&#160;&#160;"><var>$dest.sector&#160;=&#160;</var><var>$ship.dest&#160;-&gt;</var><text>&#160;get&#160;sector</text></line>
<line indent="&#160;&#160;"><var>$jumps&#160;=&#160;</var><text>get&#160;jumps&#160;from&#160;sector&#160;</text><var>[SECTOR]</var><text>&#160;to&#160;sector&#160;</text><var>$dest.sector</var></line>
<line indent="&#160;&#160;"><var>do&#160;if&#160;</var><var>$jumps</var><text>&#160;</text><var>&lt;=</var><text>&#160;</text><var>1</var></line>
<line indent="&#160;&#160;&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"></line>
<line indent="&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;relation&#160;against&#160;</text><var>$attacker</var><text>&#160;to&#160;</text><var>Foe</var></line>
<line indent="&#160;"><var>$flags&#160;=&#160;</var><var>[Find.Nearest]</var><text>&#160;</text><var>|</var><text>&#160;</text><var>[Find.DockingAllowed]</var></line>
<line indent="&#160;"><var>$station&#160;=&#160;</var><text>find&#160;station:&#160;sector=</text><var>[SECTOR]</var><text>&#160;class&#160;or&#160;type=</text><var>Station</var><text>&#160;race=</text><var>null</var><text>&#160;flags=</text><var>$flags</var><text>&#160;refobj=</text><var>[THIS]</var><text>&#160;maxdist=</text><var>null</var><text>&#160;maxnum=</text><var>1</var><text>&#160;refpos=</text><var>null</var></line>
<line indent="&#160;"><var>if&#160;</var><var>$station&#160;-&gt;</var><text>&#160;exists</text></line>
<line indent="&#160;&#160;"><var>do&#160;if&#160;</var><var>$station</var><text>&#160;</text><var>==</var><text>&#160;</text><var>$ship.dest</var></line>
<line indent="&#160;&#160;&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent="&#160;&#160;"></line>
<line indent="&#160;&#160;"><var>$followmode&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;follow&#160;mode</text></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;follow&#160;mode&#160;</text><var>[FALSE]</var></line>
<line indent="&#160;&#160;"><text>set&#160;script&#160;priority&#160;to&#160;</text><var>50</var></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>!ship.sh.attack.ts.flee</call><text>&#160;:&#160;</text><text>&#160;the&#160;attacker=</text><var>$attacker</var><text>&#160;</text><text>&#160;station&#160;to&#160;dock&#160;at=</text><var>$station</var></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>set&#160;follow&#160;mode&#160;</text><var>$followmode</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""><text>return&#160;</text><var>[TRUE]</var></line>
<line indent=""><text>endsub</text></line>
<line indent=""></line>
<line indent=""><var>sub.Evade</var><text>:</text></line>
<line interruptable="@" indent=""><var>=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>plugin.turbo.npcuse</call><text>&#160;:&#160;</text></line>
<line indent=""><var>if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;in&#160;active&#160;sector</text></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.IsLittleShip</var></line>
<line indent="&#160;"><var>if&#160;</var><var>$littleship</var><text>&#160;</text><var>AND</var><text>&#160;</text><var>$action</var><text>&#160;</text><var>!=</var><text>&#160;</text><var>[ACTION_LAND_IN_STATION]</var><text>&#160;</text><var>AND</var><text>&#160;</text><var>$action</var><text>&#160;</text><var>!=</var><text>&#160;</text><var>[ACTION_ENTER_GATE]</var><text>&#160;</text><var>AND</var><text>&#160;</text><var>$attacker</var></line>
<line indent="&#160;&#160;"><var>$shieldrandom&#160;=&#160;</var><text>random&#160;value&#160;from&#160;</text><var>3000</var><text>&#160;to&#160;</text><var>6000</var><text>&#160;-&#160;1</text></line>
<line indent="&#160;&#160;"><var>$hullrandom&#160;=&#160;</var><text>random&#160;value&#160;from&#160;</text><var>50</var><text>&#160;to&#160;</text><var>80</var><text>&#160;-&#160;1</text></line>
<line indent="&#160;&#160;"><var>$hull&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;hull&#160;percent</text></line>
<line indent="&#160;&#160;"><var>$shield&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;get&#160;current&#160;shield&#160;strength</text></line>
<line indent="&#160;&#160;"><var>if&#160;</var><var>$shield</var><text>&#160;</text><var>&lt;</var><text>&#160;</text><var>$shieldrandom</var><text>&#160;</text><var>OR</var><text>&#160;</text><var>$hull</var><text>&#160;</text><var>&lt;</var><text>&#160;</text><var>$hullrandom</var></line>
<line indent="&#160;&#160;&#160;"><var>$intensity&#160;=&#160;</var><text>random&#160;value&#160;from&#160;</text><var>80</var><text>&#160;to&#160;</text><var>100</var><text>&#160;-&#160;1</text></line>
<line indent="&#160;&#160;&#160;"><var>$timeout&#160;=&#160;</var><text>random&#160;value&#160;from&#160;</text><var>5000</var><text>&#160;to&#160;</text><var>15000</var><text>&#160;-&#160;1</text></line>
<line interruptable="@" indent="&#160;&#160;&#160;"><var>=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;defensive&#160;move:&#160;type=</text><var>null</var><text>,&#160;intensity=</text><var>$intensity</var><text>,&#160;timeout=</text><var>$timeout</var><text>ms,&#160;avoid&#160;object=</text><var>$attacker</var></line>
<line indent="&#160;&#160;"><text>end</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""><text>endsub</text></line>
<line indent=""><text>return&#160;</text><var>null</var></line>
</sourcetext>
<codearray>

<sval type="array" size="10">
  <sval type="string" val="!ship.signal.attacked"/>
  <sval type="int" val="62"/>
  <sval type="string" val="Asynchron signal. attacked"/>
  <sval type="int" val="12"/>
  <sval type="int" val="0"/>
  <sval type="array" size="25">
    <sval type="string" val="attacker"/>
    <sval type="string" val="action"/>
    <sval type="string" val="a.fromFollower"/>
    <sval type="string" val="cmd"/>
    <sval type="string" val="pilot"/>
    <sval type="string" val="owner"/>
    <sval type="string" val="noto"/>
    <sval type="string" val="response.type"/>
    <sval type="string" val="attacktarget"/>
    <sval type="string" val="has.laser"/>
    <sval type="string" val="followmode"/>
    <sval type="string" val="littleship"/>
    <sval type="string" val="drone.time"/>
    <sval type="string" val="time"/>
    <sval type="string" val="ship.dest"/>
    <sval type="string" val="dest.sector"/>
    <sval type="string" val="jumps"/>
    <sval type="string" val="flags"/>
    <sval type="string" val="station"/>
    <sval type="string" val="shieldrandom"/>
    <sval type="string" val="hullrandom"/>
    <sval type="string" val="hull"/>
    <sval type="string" val="shield"/>
    <sval type="string" val="intensity"/>
    <sval type="string" val="timeout"/>
  </sval>
  <sval type="array" size="120">
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610612216"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="7"/>
      <sval type="int" val="10"/>
      <sval type="int" val="12"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="8">
      <sval type="int" val="102"/>
      <sval type="string" val="!lib.canattack"/>
      <sval type="int" val="-536869881"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610609661"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="7"/>
      <sval type="int" val="10"/>
      <sval type="int" val="10"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="525"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610609661"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="3"/>
      <sval type="int" val="18"/>
      <sval type="int" val="0"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610610424"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="3"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="1936"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="706"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="4"/>
      <sval type="int" val="-536867833"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610608125"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="7"/>
      <sval type="int" val="10"/>
      <sval type="int" val="10"/>
      <sval type="int" val="15"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="1187"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610608125"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
      <sval type="int" val="10"/>
      <sval type="int" val="10"/>
      <sval type="int" val="15"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="726"/>
      <sval type="int" val="6"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="13"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610608125"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="6"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="340"/>
      <sval type="int" val="15"/>
      <sval type="int" val="4"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="4"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="1072"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610607608"/>
      <sval type="string" val="lib.ship.signal.attacked.trader"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="2653"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="705"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610606845"/>
      <sval type="int" val="12"/>
      <sval type="int" val="2135"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="7"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="396"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610605821"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="395"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="69"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610604795"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="397"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="69"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="105"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610604027"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="398"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="78"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610597115"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="396"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="105"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="146"/>
      <sval type="int" val="-1610603000"/>
      <sval type="int" val="4"/>
      <sval type="int" val="99"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="522"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="8"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-536860409"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
      <sval type="int" val="15"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-536859897"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="3"/>
      <sval type="int" val="15"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="-536859385"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="706"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-536858873"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="727"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-536858361"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="69"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="717"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610597629"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="9"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="518"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="517"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="109"/>
      <sval type="int" val="4"/>
      <sval type="int" val="99"/>
    </sval>
    <sval type="array" size="10">
      <sval type="int" val="102"/>
      <sval type="string" val="!fight.attack.object"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="2"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="517"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="146"/>
      <sval type="int" val="-536855290"/>
      <sval type="int" val="4"/>
      <sval type="int" val="50"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="78"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.IsLittleShip"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="705"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="11"/>
      <sval type="int" val="12"/>
      <sval type="int" val="2133"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="705"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610595832"/>
      <sval type="int" val="12"/>
      <sval type="int" val="2026"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="11"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="705"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610595320"/>
      <sval type="int" val="12"/>
      <sval type="int" val="2027"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="11"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.DropDrones"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="2692"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610593021"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="156"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="drop.drones"/>
      <sval type="int" val="12"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="141"/>
      <sval type="int" val="13"/>
    </sval>
    <sval type="array" size="30">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610593021"/>
      <sval type="int" val="8"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="12"/>
      <sval type="int" val="15"/>
      <sval type="int" val="65556"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="13"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="12"/>
      <sval type="int" val="4"/>
      <sval type="int" val="180"/>
      <sval type="int" val="15"/>
      <sval type="int" val="11"/>
      <sval type="int" val="15"/>
      <sval type="int" val="2"/>
      <sval type="int" val="15"/>
      <sval type="int" val="10"/>
      <sval type="int" val="10"/>
      <sval type="int" val="65556"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="10"/>
      <sval type="int" val="-3"/>
      <sval type="int" val="2"/>
      <sval type="int" val="16"/>
      <sval type="int" val="-4"/>
      <sval type="int" val="11"/>
      <sval type="int" val="-5"/>
      <sval type="int" val="17"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="drop.drones"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="8">
      <sval type="int" val="546"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610593021"/>
      <sval type="int" val="4"/>
      <sval type="int" val="4"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="drop.drones"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="13"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.Flee"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="1072"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-536844540"/>
      <sval type="string" val="!ship.sh.attack.ts.flee"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="69"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="1498"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610591229"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="1643"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610591224"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="31">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610590717"/>
      <sval type="int" val="9"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="402"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="403"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="15"/>
      <sval type="int" val="10"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="15"/>
      <sval type="int" val="10"/>
      <sval type="int" val="9"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
      <sval type="int" val="10"/>
      <sval type="int" val="-4"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-5"/>
      <sval type="int" val="10"/>
      <sval type="int" val="-8"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="520"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="14"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="706"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="14"/>
      <sval type="int" val="-1610589181"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="703"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="14"/>
      <sval type="int" val="15"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="711"/>
      <sval type="int" val="16"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="6"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="15"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610589176"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="16"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
      <sval type="int" val="15"/>
      <sval type="int" val="5"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="5"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="744"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="14"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="17"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="106"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="131"/>
      <sval type="int" val="15"/>
      <sval type="int" val="7"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="7"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="18">
      <sval type="int" val="794"/>
      <sval type="int" val="18"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="6"/>
      <sval type="int" val="12"/>
      <sval type="int" val="2016"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="17"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="706"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="18"/>
      <sval type="int" val="-1610586365"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610587640"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="18"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="14"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="518"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="517"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="109"/>
      <sval type="int" val="4"/>
      <sval type="int" val="50"/>
    </sval>
    <sval type="array" size="10">
      <sval type="int" val="102"/>
      <sval type="string" val="!ship.sh.attack.ts.flee"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="2"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="18"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="517"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.Evade"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="102"/>
      <sval type="string" val="plugin.turbo.npcuse"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="761"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610582525"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="62"/>
    </sval>
    <sval type="array" size="37">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610582525"/>
      <sval type="int" val="11"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="11"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="402"/>
      <sval type="int" val="15"/>
      <sval type="int" val="1"/>
      <sval type="int" val="15"/>
      <sval type="int" val="9"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="403"/>
      <sval type="int" val="15"/>
      <sval type="int" val="1"/>
      <sval type="int" val="15"/>
      <sval type="int" val="9"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="15"/>
      <sval type="int" val="9"/>
      <sval type="int" val="11"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="9"/>
      <sval type="int" val="-2"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-3"/>
      <sval type="int" val="9"/>
      <sval type="int" val="-6"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-7"/>
      <sval type="int" val="9"/>
      <sval type="int" val="-10"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="110"/>
      <sval type="int" val="19"/>
      <sval type="int" val="4"/>
      <sval type="int" val="3000"/>
      <sval type="int" val="4"/>
      <sval type="int" val="6000"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="110"/>
      <sval type="int" val="20"/>
      <sval type="int" val="4"/>
      <sval type="int" val="50"/>
      <sval type="int" val="4"/>
      <sval type="int" val="80"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="900"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="21"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="714"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="22"/>
    </sval>
    <sval type="array" size="25">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610582525"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="22"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="19"/>
      <sval type="int" val="15"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="21"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="20"/>
      <sval type="int" val="15"/>
      <sval type="int" val="3"/>
      <sval type="int" val="15"/>
      <sval type="int" val="10"/>
      <sval type="int" val="7"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-2"/>
      <sval type="int" val="10"/>
      <sval type="int" val="-4"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-5"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="110"/>
      <sval type="int" val="23"/>
      <sval type="int" val="4"/>
      <sval type="int" val="80"/>
      <sval type="int" val="4"/>
      <sval type="int" val="100"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="110"/>
      <sval type="int" val="24"/>
      <sval type="int" val="4"/>
      <sval type="int" val="5000"/>
      <sval type="int" val="4"/>
      <sval type="int" val="15000"/>
    </sval>
    <sval type="array" size="12">
      <sval type="int" val="565"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="23"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="24"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
  </sval>
  <sval type="array" size="3">
    <sval type="array" size="2">
      <sval type="int" val="22"/>
      <sval type="string" val="the attacker"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="10"/>
      <sval type="string" val="action"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="63"/>
      <sval type="string" val="Is From follower"/>
    </sval>
  </sval>
  <sval type="array" size="51">
    <sval type="array" size="2">
      <sval type="int" val="2"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="2"/>
      <sval type="int" val="1"/>
      <sval type="string" val="if its the same race, then dont react"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="4"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="12"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="12"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="12"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="12"/>
      <sval type="int" val="1"/>
      <sval type="string" val="dont counter attack friendlies"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="18"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="18"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="18"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="18"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="18"/>
      <sval type="int" val="1"/>
      <sval type="string" val="ST/UT use their own signals:"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="20"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="23"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="23"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="26"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="30"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="33"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="36"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="36"/>
      <sval type="int" val="1"/>
      <sval type="string" val="check if already a attack is executed"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="38"/>
      <sval type="int" val="1"/>
      <sval type="string" val="already attacking the attacker..."/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="49"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="50"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="54"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="56"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="61"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="61"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="62"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="62"/>
      <sval type="int" val="1"/>
      <sval type="string" val="Changelog:"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="62"/>
      <sval type="int" val="1"/>
      <sval type="string" val="v3: script does not trigger response if response is already running (on task 50)"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="62"/>
      <sval type="int" val="1"/>
      <sval type="string" val="v4: ships without fight software flee, do not ignore attack"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="62"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="69"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="77"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="77"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="77"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="78"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="81"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="84"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="84"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="86"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="86"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="92"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="92"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="98"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="103"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="103"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="105"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="118"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="118"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="118"/>
      <sval type="int" val="4"/>
    </sval>
  </sval>
  <sval type="int" val="0"/>
</sval>

</codearray>
<nosignature>7691</nosignature>
</script>
